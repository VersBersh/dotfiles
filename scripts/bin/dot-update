#!/usr/bin/env bash

# Quick script to handle updating our dotfiles

# A better class of script...
set -o errexit          # Exit on most errors (see the manual)
set -o errtrace         # Make sure any error trap is inherited
set -o pipefail         # Exit on failures earlier in a pipeline
#set -o xtrace          # Trace the execution of the script (debug)

orig_dir="$PWD"
script_dir="$(dirname "$(readlink -f "${BASH_SOURCE[0]}")")"
dotfiles_dir="$(cd "$script_dir"; git rev-parse --show-toplevel)"

echo '*** Updating Git sources...'
cd "$dotfiles_dir"
git fetch
git merge --ff-only
git submodule init
git submodule update

echo -e "\n*** Updating Vim bundles..."
vim +PluginUpdate +qall

cd "$orig_dir"
echo -e "\n*** Done!"

# vim: syntax=sh cc=80 tw=79 ts=4 sw=4 sts=4 et sr
